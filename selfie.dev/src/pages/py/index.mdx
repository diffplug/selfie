import { FooterCTA } from "@/components/FooterCTA/FooterCTA";
import { NavHeading } from "@/components/NavHeading";

export const showHeroLinks = "true";
export const title = "Selfie Python Snapshot Testing";
export const description =
  "Zero-config inline and disk snapshots for Python. Features garbage collection, filesystem-like APIs for snapshot data, and novel techniques for storytelling within test code.";

<NavHeading text="literal" popout="/py/get-started#quickstart" />

This is a reasonable way to test.

```python
def test_primes_below_100():
    result = primes_below(100)
    assert result[:4] == [2, 3, 5, 7]
    assert result[-2:] == [89, 97]
```

But oftentimes a more useful way to test is actually:

```python
def test_mc_test_face():
    print(primes_below(100))
```

With literal snapshots, you can `print` directly into your testcode, combining the speed and freedom of `print` with the repeatability and collaborative spirit of conventional assertions.

```python
def test_primes_below_100():
    expect_selfie(primes_below(100)).to_be([
        2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97
    ])
```

And from now on it's a proper assertion, but you didn't have to spend any time writing it. It's not only less work, but also more complete than the usual `.startsWith().endsWith()` rigamarole.

## Implementation Status

‚úÖ Implemented:
- Basic snapshot testing
- Inline literals
- Web examples (facets)
- HTML pretty printing
- Markdown conversion

‚ö†Ô∏è Partially implemented:
- Disk snapshots (basic functionality)
- CI mode integration

‚ùå Not implemented/WIP:
- Cache functionality ([Issue #302](https://github.com/diffplug/selfie/issues/302))
- Binary data handling
- Typed data roundtripping
- AI examples ([Issue #319](https://github.com/diffplug/selfie/issues/319))

<NavHeading text="like-a-filesystem" popout="/py/get-started#disk" />

> üöß **Work in Progress**: Filesystem-like features
>
> Advanced disk snapshot features are currently under development. Basic disk snapshots are available using `to_match_disk()`, but advanced features like custom snapshot folders and binary data handling are still in progress.

```python
def test_gzip_favicon():
    expect_selfie(get("/favicon.ico", ContentEncoding.GZIP)).to_match_disk()

def test_order_flow():
  expect_selfie(get("/orders")).to_match_disk("initial")
  post_order()
  expect_selfie(get("/orders")).to_match_disk("ordered")
```

<NavHeading text="lensable" popout="/py/facets" />

> üöß **Work in Progress**: Advanced Facet Features
>
> While basic faceting is implemented for web testing and HTML/Markdown conversion, some advanced features are still under development. See the [facets section](/py/facets) for currently available features.

```python
class Snapshot:
  subject: SnapshotValue
  facets: frozendict[str, SnapshotValue]

class Lens(ABC) :
  def transform(self, snapshot: Snapshot) -> Snapshot:
    pass

class Camera(Generic [T]):
  def snapshot(self, subject: T) -> Snapshot:
    pass
  def with_lens(self, lens: Lens) -> 'Camera':
    # returns a new Camera which applies the given lens to every snapshot
```

<NavHeading text="cacheable" popout="/py/cache" />

> ‚ö†Ô∏è **Note**: Cache Functionality
>
> Cache functionality is currently under development ([Issue #302](https://github.com/diffplug/selfie/issues/302)). This includes features for caching test results and handling non-deterministic data. See the [cache documentation](/py/cache) for updates.

<FooterCTA />
